<html><head><title>Image Tools</title><meta content="width=device-width,initial-scale=1" name="viewport"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><style>canvas{display:block;margin:0 auto;max-width:100%;border:1px solid #ededed}.form-inline input{max-width:90px}.panel-primary .panel-heading{cursor:pointer}</style></head><body><div class="container-fluid"><div class="row"><div class="col-sm-4 col-md-3"><div class="well"><div class="form-group"><label for="file">Choose a file:</label><input type="file" accept="image/*" id="file"></div><div class="panel panel-primary"><div class="panel-heading" data-toggle="collapse" data-target="#collapseDimension" aria-expanded="true" aria-controls="collapseDimension"><h4 class="panel-title">Size & position</h4></div><div class="panel-body collapse in" id="collapseDimension"><div class="form-group"><div class="btn-group btn-group-sm"><button type="button" class="btn btn-default" id="imgPosTop">Top</button> <button type="button" class="btn btn-default" id="imgPosRight">Right</button> <button type="button" class="btn btn-default" id="imgPosBottom">Bottom</button> <button type="button" class="btn btn-default" id="imgPosLeft">Left</button></div><div class="btn-group btn-group-sm"><button type="button" class="btn btn-default" id="imgPosCenter">Horizontal center</button> <button type="button" class="btn btn-default" id="imgPosVCenter">Vertical center</button></div></div><div class="form-group"><label>Working plan size:</label><div class="form-inline"><input class="form-control" type="number" id="canvasW" placeholder="width"> x <input class="form-control" type="number" id="canvasH" placeholder="height"> pixels</div></div><div class="form-group"><label>Image size:</label><div class="form-inline"><input class="form-control" type="number" id="imgW" placeholder="width"> x <input class="form-control" type="number" id="imgH" placeholder="height"> pixels</div><div class="checkbox"><label for="aspectRatio"><input type="checkbox" id="aspectRatio"> &nbsp; keep aspect ratio</label></div></div><div class="form-group"><label>Image positions:</label><div class="form-inline"><input class="form-control" type="number" id="imgPosX" placeholder="X"> <input class="form-control" type="number" id="imgPosY" placeholder="Y"> pixels</div></div><div class="form-group"><label>Image rotation:</label><input class="form-control" type="number" id="imgRotate" placeholder="Rotate"></div></div></div><div class="panel panel-primary"><div class="panel-heading" data-toggle="collapse" data-target="#collapseFilters" ria-expanded="false" aria-controls="collapseFilters"><h4 class="panel-title">Filters</h4></div><div class="panel-body collapse" id="collapseFilters"><div class="checkbox"><label for="invert"><input type="checkbox" class="filter invert" id="invert" value="invert"> &nbsp; Invert</label></div><div class="checkbox"><label for="grayscale"><input type="checkbox" class="filter grayscale" id="grayscale" value="grayscale"> &nbsp; Grayscale</label></div><div class="checkbox"><label for="sepia"><input type="checkbox" class="filter sepia" id="sepia" value="sepia"> &nbsp; Sepia</label></div><div class="checkbox"><label for="blur"><input type="checkbox" class="filter blur" id="blur" value="blur"> &nbsp; Blur</label></div><div class="checkbox"><label for="noise"><input type="checkbox" class="filter noise" id="noise" value="noise"> &nbsp; Noise</label></div><div class="checkbox"><label for="brightness"><input type="checkbox" class="filter brightness" id="brightness" value="brightness"> &nbsp; Brightness</label></div><div class="checkbox"><label for="blackandwhite"><input type="checkbox" class="filter blackandwhite" id="blackandwhite" value="blackAndWhite"> &nbsp; Black and white</label></div><div class="panel panel-default"><div class="panel-heading"><div class="panel-title"><small>Noise adjustement</small></div></div><div class="panel-body"><div class="form-group noise-options"><input type="range" min="1" max="100" id="factor"></div></div></div><div class="panel panel-default"><div class="panel-heading"><div class="panel-title"><small>Brightness adjustement</small></div></div><div class="panel-body"><div class="form-group brightness-options"><input type="range" min="1" max="100" id="adjustement"></div></div></div><div class="panel panel-default"><div class="panel-heading"><div class="panel-title"><small>Black and white adjustement</small></div></div><div class="panel-body"><div class="form-group blackandwhite-options"><input type="range" min="1" max="255" id="threshold"></div></div></div></div></div><div class="form-group"><a class="btn btn-primary">Export</a></div></div></div><div class="col-sm-8 col-md-9"><div class="panel panel-default"><div class="panel-heading">Preview</div><div class="panel-body"><canvas id="preview"></canvas></div></div></div></div></div><script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script type="text/javascript">function slice(e){return Array.prototype.slice.call(e)}function el(e){return document.querySelector(e)}function els(e){return slice(document.querySelectorAll(e))}function onChange(e,n){el(e).addEventListener("change",n)}function onClick(e,n){el(e).addEventListener("click",n)}function handler(){var e=els('.filter[type="checkbox"]:checked');renderImg(function(){e.forEach(function(e){runFilter(e.value)})})}function readFile(e,n){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){n(e.target.result)},t.readAsDataURL(e.files[0])}}function runFilter(e){var n=el("canvas").getContext("2d"),t=null;if("brightness"==e){var a=el("#adjustement");t=parseInt(a.value,10)}else if("blackAndWhite"==e){var r=el("#threshold");t=parseInt(r.value,10)}else if("noise"==e){var i=el("#factor");t=parseInt(i.value,10)}var l=filterImage(Filters[e],t);n.putImageData(l,0,0)}function renderImg(e){readFile(el("input"),function(n){var t=new Image;t.onload=function(){var n=el("input#imgW"),a=el("input#imgH"),r=el("input#canvasW"),i=el("input#canvasH"),l=el("input#imgPosX"),u=el("input#imgPosY"),o=el("input#aspectRatio"),c=el("input#imgRotate"),s=t.height/t.width,v=parseInt(n.value,10)||t.width,d=parseInt(a.value,10)||t.height,f=parseInt(r.value,10)||t.width,g=parseInt(i.value,10)||t.height,h=parseInt(l.value,10)||0,m=parseInt(u.value,10)||0,p=parseInt(c.value,10)||0,I=getCanvas(f,g).getContext("2d");o.checked&&(d=v*s),n.value=v,a.value=d,r.value=f,i.value=g,l.value=h,u.value=m,0!==p&&I.rotate(p*Math.PI/180),I.drawImage(t,h,m,v,d),e&&e()},t.src=n})}function getPixels(){var e=el("canvas");return e.getContext("2d").getImageData(0,0,e.width,e.height)}function getCanvas(e,n){var t=el("canvas");return t.width=e,t.height=n,t}function filterImage(e,n){for(var t=[getPixels()],a=1;a<arguments.length;a++)t.push(arguments[a]);return e.apply(null,t)}function download(){var e=el("canvas");$link.href=e.toDataURL("image/png"),$link.download="output.png"}els('.filter[type="checkbox"]').forEach(function(e){e.addEventListener("change",handler)});var selectors=["input","#adjustement","#factor","#threshold","input#canvasW","input#canvasH","input#imgW","input#imgH","input#aspectRatio","input#imgPosX","input#imgPosY","input#ImgRotate"];selectors.forEach(function(e){onChange(e,handler)}),onClick("a",download),el("button#imgPosTop").addEventListener("click",function(){el("#imgPosY").value=0,handler()}),el("button#imgPosRight").addEventListener("click",function(){var e=el("#canvasW").value,n=el("#imgW").value;el("#imgPosX").value=e-n,handler()}),el("button#imgPosBottom").addEventListener("click",function(){var e=el("#canvasH").value,n=el("#imgH").value;el("#imgPosY").value=e-n,handler()}),el("button#imgPosLeft").addEventListener("click",function(){el("#imgPosX").value=0,handler()}),el("button#imgPosCenter").addEventListener("click",function(){var e=el("#canvasW").value,n=el("#imgW").value;el("#imgPosX").value=(e-n)/2,handler()}),el("button#imgPosVCenter").addEventListener("click",function(){var e=el("#canvasH").value,n=el("#imgH").value;el("#imgPosY").value=(e-n)/2,handler()}),function(e){function n(e,n,t){for(var a=e.data,r=a.length,i=[].concat(n[0],n[1],n[2]),l=0,u=e.width,o=0;o<r;o++)if((o+1)%4!=0){l=0;for(var c=[a[o-4*u-4]||a[o],a[o-4*u]||a[o],a[o-4*u+4]||a[o],a[o-4]||a[o],a[o],a[o+4]||a[o],a[o+4*u-4]||a[o],a[o+4*u]||a[o],a[o+4*u+4]||a[o]],s=0;s<9;s++)l+=c[s]*i[s];l/=9,t&&(l+=t),l=Math.min(Math.max(l,0),255),a[o]=l}return e}window.Filters={grayscale:function(e){for(var n=e.data,t=0;t<n.length;t+=4){var a=.2126*n[t]+.7152*n[t+1]+.0722*n[t+2];n[t]=n[t+1]=n[t+2]=a}return e},sepia:function(e){for(var n=e.data,t=0;t<n.length;t+=4){var a=.3*n[t]+.59*n[t+1]+.11*n[t+2];n[t]=a+100,n[t+1]=a+50,n[t+2]=a}return e},invert:function(e){for(var n=e.data,t=0;t<n.length;t+=4)n[t]=255-n[t],n[t+1]=255-n[t+1],n[t+2]=255-n[t+2];return e},brightness:function(e,n){for(var t=e.data,a=0;a<t.length;a+=4)t[a]+=n||40,t[a+1]+=n||40,t[a+2]+=n||40;return e},noise:function(e,n){for(var t=e.data,a=0;a<t.length;a+=4){var r=(.5-Math.random())*n;t[a]=t[a]+r,t[a+1]=t[a+1]+r,t[a+2]=t[a+2]+r}return e},blackAndWhite:function(e,n){for(var t=e.data,a=0;a<t.length;a+=4){var r=.2126*t[a]+.7152*t[a+1]+.0722*t[a+2]>=(n||128)?255:0;t[a]=t[a+1]=t[a+2]=r}return e},blur:function(e){return n(e,[[1,1,1],[1,1,1],[1,1,1]])},sharpen:function(e){return n(e,[[0,-2,0],[-2,11,-2],[0,-2,0]])},emboss:function(e){return n(e,[[2,0,0],[0,-1,0],[0,0,-1]],127)},lighten:function(e){return n(e,[[0,0,0],[0,12,0],[0,0,0]])},darken:function(e){return n(e,[[0,0,0],[0,6,0],[0,0,0]])},edge:function(e){return n(e,[[1,1,1],[1,-7,1],[1,1,1]])},identity:function(e){return n(e,[[0,0,0],[0,9,0],[0,0,0]])}}}()</script></body></html>